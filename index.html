<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Lambda Selections</title>
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Call the Lambda function to populate the selection menus on page load
    fetchLambdaData('getSelections', {});

    // Event listener for the submit button
    document.getElementById('submit').addEventListener('click', function() {
        // Collect selections
        const selections = Array.from({ length: 9 }).map((_, i) => {
            return document.getElementById(`select${i + 1}`).value;
        });

        // Send selections to Lambda
        fetchLambdaData('processSelections', { selections: selections });
    });
});

// Function to communicate with the Lambda function
function fetchLambdaData(action, data) {
    const apiEndpoint = 'https://pu14ug6ii9.execute-api.us-east-2.amazonaws.com/default/digixp_231030_x'; // Replace with your API Gateway URL

    fetch(apiEndpoint, {
        method: 'POST',
        body: JSON.stringify({ action, ...data }),
        headers: {
            'Content-Type': 'application/json'
        }
    })
    .then(response => response.json())
    .then(data => {
        if (action === 'getSelections') {
            // Populate the selection menus
            for (let i = 0; i < 9; i++) {
                const select = document.getElementById(`select${i + 1}`);
                data.selections[i].forEach(optionValue => {
                    const option = new Option(optionValue, optionValue);
                    select.add(option);
                });
            }
        } else if (action === 'processSelections') {
            // Handle the processed data
            document.getElementById('result').textContent = data.result;
        }
    })
    .catch(error => console.error('Error:', error));
}
</script>
</head>
<body>
<div>
    <!-- Selection Menus -->
    <div id="selection-menus">
        <script>
        for (let i = 1; i <= 9; i++) {
            document.write(`<label for="select${i}">Selection ${i}:</label>
            <select id="select${i}"></select><br/>`);
        }
        </script>
    </div>

    <!-- Submit Button -->
    <button id="submit">Submit</button>

    <!-- Result Display -->
    <div id="result"></div>
</div>
</body>
</html>
